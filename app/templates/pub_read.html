{% extends 'navbar.html' %}

{% block title %}Pub Details{% endblock %}

{% block script %}
<script type="text/javascript" src="{{ url_for('static', filename='javascript/maps/show_map.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/maps/add_markers.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/maps/map_listen_click.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/maps/map_listen_bounds.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/maps/listen_events.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/maps/listen_search.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/maps/class_event_handler.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/maps/mouse_down_click.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/html/insert_line.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/html/populate_form.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/sum_score.js') }}"></script>

<script>
function onLoad(){

    console.log("onLoad in pub_read");
    pub_review = {{ pub_review | tojson }}
    config = {{ config | tojson }}
    pub_fields = config['pub']['column']
    review_fields = config['review']['column']
    pub_review_fields = config['pub']['column'].concat(config['review']['column'])
    input_controls = config['control']['input']
    dropdown_controls = config['control']['dropdown']
    slider_controls = config['control']['slider']
    check_controls = config['control']['check']
    score_list = config['review']['score']
    form = {{ form_type | tojson }}
    populate_form(form);

    var js = document.createElement("script");
    js.type = "text/javascript";
    if ( window.navigator.onLine == true) {
        js.src = 'https://maps.googleapis.com/maps/api/js?key={{google_key}}&libraries=places&callback=initMap'
        document.head.appendChild(js)
    } else {
        alert('You appear to offline so maps cannot be displayed')
    }

}

function initMap(){
    console.log("initMap in pub_read");
    pub_review = {{ pub_review | tojson }}
    zoom = 19
    map = show_map(pub_review[0]['latitude'], pub_review[0]['longitude'], zoom)
    add_markers(map, zoom, pub_review)
}
</script>


{% endblock %}

{% block full_screen %}
<div><h2>{{pub_review[0]['name']}}</h2></div>
<div id="map" style="width:100%; height:300px;"></div>
{% endblock %}

{% block form %}
    {% include "pub_form.html" %}
{% endblock %}

{% block pub_read_btn %}<a class="nav-link active_custom" href="{{ url_for('pub_read', pub_id=pub_review[0]['pub_identity']) }}">View</a>{% endblock %}</li>
{% block rev_read_btn %}{% endblock %}
{% block rev_add_btn %}{% endblock %}
{% block rev_edit_btn %}{% endblock %}
{% block rev_del_btn %}{% endblock %}

{% block search_btn %}{% endblock %}

{% block footer %}
            <div>Dinner icon made by <a href="https://www.flaticon.com/authors/pause08">Pause08</a><a> from </a><a href="https://www.flaticon.com/"> www.flaticon.com</a></div>
            <div>Park icon made by <a href="https://www.flaticon.com/authors/freepik">Freepik</a><a> from </a><a href="https://www.flaticon.com/"> www.flaticon.com</a></div>
            <div>Live sport icon made by <a href="https://www.flaticon.com/authors/Mihimihi">Mihimihi</a><a> from </a><a href="https://www.flaticon.com/"> www.flaticon.com</a></div>
            <div>Toilet icon made by <a href="https://www.flaticon.com/authors/syafii5758">syafii5758</a><a> from </a><a href="https://www.flaticon.com/"> www.flaticon.com</a></div>
            <div>Nightclub icon made by <a href="https://www.flaticon.com/authors/iconixar">iconixar</a><a> from </a><a href="https://www.flaticon.com/"> www.flaticon.com</a></div>
            <div>Dartboard icon made by <a href="https://www.flaticon.com/authors/nhor-phai">Nhor Phai</a><a> from </a><a href="https://www.flaticon.com/"> www.flaticon.com</a></div>
{% endblock %}