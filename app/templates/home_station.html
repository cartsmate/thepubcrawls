<div class="row">
    <div class="col-12 center-block text-center">
        <a href="/pub/areas" style="font-weight: bold; font-size: 16px; color: #000000; text-decoration: none;">Search pubs by area</a>
    </div>
</div>
<div class="row">
    <div class="col mx-auto">
        <div class="d-flex justify-content-center">
            <select class="form-control" id="direction" name="direction" onchange="direction_changed();" style="background-color: #FFFFFF; width:220px;">
                <option value="all">select direction</option>
                {% for direction in directions_list %}
                    <option value={{direction[0]}}>{{direction[1]}}</option>
                {% endfor %}
            </select>
            <a><img src="/static/icons/buttons/arrow.png" onClick="go_week()" class="button_size"></a>
        </div>
    </div>
</div>
<div class="row">
    <div class="col mx-auto">
        <div class="d-flex justify-content-center" style="font-weight: bold;">
             and/or
        </div>
    </div>
</div>
<div class="row">
    <div class="col mx-auto">
        <div class="d-flex justify-content-center">
            <select class="form-control" id="station" name="station" onchange="station_changed();" style="background-color: #FFFFFF; width:220px;">
                <option value="all">select station</option>
                {% for x in stations_directions_list %}
                    <option value={{x[0]}}>{{x[1]}}</option>
                {% endfor %}
            </select>
            <a><img src="/static/icons/buttons/arrow.png" onClick="go_week()" class="button_size"></a>
        </div>
    </div>
</div>

<script>
function removeOptions(selectElement) {
   var i, L = selectElement.options.length - 1;
   for(i = L; i >= 0; i--) {
      selectElement.remove(i);
   }
}
function direction_changed() {
    var directionSelect = document.getElementById("direction");
    var selectedText = directionSelect.options[directionSelect.selectedIndex].text;
    value = document.getElementById("direction").value
    //console.log(value)
    //console.log(selectedText)
    document.getElementById("station").selectedIndex = 0;
    stations_directions_list = {{ stations_directions_list | tojson }}
    var select = document.getElementById("station");
    removeOptions(document.getElementById('station'));
    var option = document.createElement("option");
    option.value = 'all'
    option.text = "the nearest station"
    select.add(option);
    if (value == 'all') {
        for(var i = 0; i < stations_directions_list.length; i++) {
            var opt = stations_directions_list[i][1];
            var el = document.createElement("option");
            el.textContent = stations_directions_list[i][1];
            el.value = stations_directions_list[i][0];
            select.appendChild(el);
        }
    } else {
        filteredArray = stations_directions_list.filter(item => item[2] == value);
        for(var i = 0; i < filteredArray.length; i++) {
            var opt = filteredArray[i][1];
            var el = document.createElement("option");
            el.textContent = filteredArray[i][1];
            el.value = filteredArray[i][0];
            select.appendChild(el);
        }
    }
}
function station_changed() {
    var station_selection = document.getElementById('station').value
    console.log(document.getElementById('station').value)
    console.log(document.getElementById('station').text)
}
</script>