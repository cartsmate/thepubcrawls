{% extends 'navbar.html' %}

{% block title %}Crawls{% endblock %}

{% block script %}
<script async defer src="https://maps.googleapis.com/maps/api/js?key={{google_key}}&libraries=marker&callback=initMap" type="text/javascript"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/maps/show_map.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='javascript/maps/latlng_avg.js') }}"></script>
<script>
function onLoad(){
    console.log("onLoad in pub_crawl")
}

function initMap() {
    var directionsService = new google.maps.DirectionsService();
    var directionsRenderer = new google.maps.DirectionsRenderer();

    var map = new google.maps.Map(document.getElementById('map'), {
        zoom:7,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    directionsRenderer.setMap(map);
<!--    directionsRenderer.setPanel(document.getElementById('panel'));-->

    var request = {
        origin: {placeId: "ChIJy2QpfVUDdkgR_ZjHMTwf28A"},
        destination: {placeId: "ChIJYdET4FQDdkgRbjvXg_CcAm0"},
        waypoints: [{stopover: true, location: { placeId: "ChIJNQsDclUDdkgRvZqcNZvdRgM" }}],
        optimizeWaypoints: false,
        travelMode: google.maps.DirectionsTravelMode.WALKING
    };

    directionsService.route(request, function(response, status) {
        var no_of_legs = response.routes[0].legs.length
        for (let i = 0; i < response.routes[0].legs.length; i++) {
            duration = response.routes[0].legs[i].duration.value/60
        }
        if (status == google.maps.DirectionsStatus.OK) {
            directionsRenderer.setDirections(response);
        }
    });

};
</script>

{% endblock %}

{% block full_screen %}

<div id="the_crawl"></div>
{% endblock %}

{% block form %}
<div id="map" style="width:100%; height:450px;"></div>
<div id="panel" style="width: 300px; float: right;"></div>
{% endblock %}

{% block image %}
<form action="{{ url_for('pub_crawl_show') }}" method="post">
    <!--<div class="form-group row">
        <label class="control-label col-sm-2" for="station">Start area:</label>
        <div class="col-sm-10">
          <select class="form-control" id="station" name="station" disabled>
              <option value="">Select starting area ---</option>
                {% for station in station_list %}
                    <option value="{{station}}">{{station}}</option>
                {% endfor %}
              <option selected="selected">ANY</option>
          </select>
        </div>
    </div>-->
    <div class="form-group row">
        <label class="control-label col-sm-2" for="start">Start pub:</label>
        <div class="col-sm-10">
          <select class="form-control" id="start" name="start" required>
              <option value=""></option>
                {% for place in place_list %}
                    <option value="{{place[1]}}">{{place[0]}}</option>
                {% endfor %}
          </select>
        </div>
    </div>
    <div class="form-group row">
        <label class="control-label col-sm-2" for="walk">Max walk:</label>
        <div class="col-sm-10">
            <select class="form-control" id="walk" name="walk">
                <option value="0">Select maximum walk between venues ---</option>
                <option value="1">1 min</option>
                <option value="3">3 min</option>
                <option value="5">5 min</option>
                <option value="10">10 min</option>
                <option value="15">15 min</option>
                <option value="0">15+ min</option>
            </select>
        </div>
    </div>
    <div class="form-group row">
        <label class="control-label col-sm-2" for="favourite">Favourite:</label>
        <div class="col-sm-10">
            <select class="form-control" id="favourite" name="favourite">
                <option value="all">Choose favourite pub category ---</option>
                <option value="atmosphere">Atmosphere</option>
                <option value="cleanliness">Cleanliness</option>
                <option value="clientele">Clientele</option>
                <option value="decor">Decor</option>
                <option value="entertainment">Entertainment</option>
                <option value="food">Food</option>
                <option value="friendliness">Friendliness</option>
                <option value="opening">Opening</option>
                <option value="price">Price</option>
                <option value="selection">Selection</option>
            </select>
        </div>
    </div>
    <div class="form-group row">
        <label class="control-label col-sm-2" for="stops">No.of stops:</label>
        <div class="col-sm-10">
            <select class="form-control" id="stops" name="stops" required>
                <option value=""></option>
                {% for number in range_list %}
                    <option value="{{number}}">{{number}}</option>
                {% endfor %}
            </select>
        </div>
    </div>
    <div class="form-group row">
        <label class="control-label col-sm-2" for="criteria">Criteria:</label>
        <div class="col-sm-10">
            <select class="form-control" id="criteria" name="criteria">
                <option value="NEAREST">Nearest</option>
                <option value="SCORE">Highest rated</option>
            </select>
        </div>
    </div>
    <div class="form-group row">
        <button id="submit" type="submit" class="btn btn-primary btn-block" name="submit" value="submit">Submit</button>
    </div>
  </div>
</form>
{% endblock %}
{% block navbar_crawls %}<a class="nav-link active_custom" href="/pub/crawl">Pub Crawls</a>{% endblock %}
{% block pub_read_btn %}{% endblock %}
{% block pub_edit_btn %}{% endblock %}
{% block pub_del_btn %}{% endblock %}
{% block rev_read_btn %}{% endblock %}
{% block rev_add_btn %}{% endblock %}
{% block rev_edit_btn %}{% endblock %}
{% block rev_del_btn %}{% endblock %}
{% block search_btn %}{% endblock %}